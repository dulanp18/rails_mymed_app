<div class="container">

  <ul class="nav nav-tabs" id="myTab" role="tablist">
    <li class="nav-item">
      <a class="nav-link active" id="home-tab" data-toggle="tab" href="#home" role="tab" aria-controls="general" aria-selected="true">General Info</a>
    </li>
    <li class="nav-item">
      <a class="nav-link" id="profile-tab" data-toggle="tab" href="#profile" role="tab" aria-controls="consults" aria-selected="false">Consultation Log</a>
    </li>
    <li class="nav-item">
      <a class="nav-link" id="contact-tab" data-toggle="tab" href="#contact" role="tab" aria-controls="prescriptions" aria-selected="false">Prescription Log</a>
    </li>
  </ul>
  <div class="tab-content" id="myTabContent">
    <div class="tab-pane fade show active" id="home" role="tabpanel" aria-labelledby="general-tab">
      <div>
        <table class="table table-striped table-dark table-hover">
        <thead>
          <tr>
            <th scope="col">Doctor Info</th>
          </tr>
        </thead>
        <tbody>
          <tr>  <th scope="row">First Name: <%= @doctor.user.first_name %></th>
                <th scope="row">Last Name: <%= @doctor.user.last_name %></th> </tr>
          <tr>  <th scope="row">Email: <%= @doctor.user.email %></th>
                <th scope="row">Contact Number: <%= @doctor.user.contact_number %></th> </tr>
          <tr>  <th scope="row">Date Of Birth: <%= @doctor.user.date_of_birth.strftime("%B %e, %Y") %></th>
                <th scope="row">Age: <%= @age %></th> </tr>
          <tr>  <th scope="row">Nationality: <%= @doctor.user.nationality %></th>
                <th scope="row">Medical License Number: <%= @doctor.medical_licence_number %></th> </tr>
          <tr>  <th scope="row">Clinic Name: <%= @doctor.clinic_of_practice %></th>
                <th scope="row">Address of Clinic: <%= @doctor.address_of_clinic_string %></th> </tr>
        </tbody>
      </table>

        <% if current_user.user_type == 'doctor' %>
          <div>
            <%= link_to "Start Consultation ", new_consultation_path %>
          </div>
        <% end %>
      </div>
    </div>

    <div class="tab-pane fade" id="profile" role="tabpanel" aria-labelledby="consults-tab">
      <table class="table table-striped table-dark table-hover">
        <thead>
          <tr>
            <th scope="col">Date Of Consultation</th>
            <th scope="col">Patient</th>
            <th scope="col">Number Of Prescriptions</th>
            <th scope="col"></th>
          </tr>
        </thead>
        <tbody>
          <% @consultations.each do |consultation| %>
          <tr>
            <th scope="row"><%= consultation.created_at.strftime("%B %e, %Y, %I:%m%P") %></th>
            <td>Dr. <%= consultation.patient.user.first_name + " " + consultation.patient.user.last_name  %></td>
            <td><%= consultation.prescriptions.length %></td>
            <td><%= link_to "View Consultation", consultation_path(consultation)   %></td>
          </tr>
          <% end %>
        </tbody>
      </table>
    </div>


    <div class="tab-pane fade" id="contact" role="tabpanel" aria-labelledby="prescriptions-tab">
      <table class="table table-striped table-dark table-hover">
          <thead>
            <tr>
              <th scope="col">Prescribed On</th>
              <th scope="col">Medicine</th>
              <th scope="col">Dose</th>
              <th scope="col">Serving Type</th>
              <th scope="col">Amount Per Serving</th>
              <th scope="col">Servings Per Day</th>
              <th scope="col">Days To Consume</th>
              <th scope="col">Directions of Consumption</th>
            </tr>
          </thead>
            <tbody>
              <% @prescriptions.each do |prescription| %>
              <tr>
                <th class="text-nowrap" scope="row"><%= prescription.created_at.strftime("%B %e, %Y, %I:%m%P") %></th>
                <td><%= prescription.medicine.name  %></td>
                <td><%= prescription.medicine.strength_of_medicine  %></td>
                <td></td>
                <td><%= prescription.amount_per_serving.to_i  %></td>
                <td><%= prescription.servings_per_day.to_i  %></td>
                <td><%= prescription.number_of_days.to_i  %></td>
                <td><%= prescription.comment.capitalize  %></td>
              </tr>
              <% end %>
            </tbody>
        </table>

    </div>
  </div>

</div>

